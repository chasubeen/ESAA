# **5. 데이터 전처리**
- ML 알고리즘은 데이터에 기반
  - 어떤 데이터를 입력으로 가지느냐에 따라 결과도 크게 달라질 수 있음
  - Garbage In, Garbage Out

- ML 알고리즘에서 전처리 사항들
  - 결손값(NaN, Null 등) 처리
    - 고정된 다른 값으로 변환
      - 평균값(피처 값 중 Null 값이 얼마 되지 않는 경우)
    - 대부분이 Null 값인 경우 해당 피처를 drop
  - 문자열 feature 처리
    - 사이킷런 ML 알고리즘은 오직 **숫자형** 변수만 처리 가능
    - 카테고리형 피처와 텍스트형 피처 처리
 
## **5-1. 데이터 인코딩**
### **a) 레이블 인코딩(Label Encoding)**
- 카테고리형 피처 -> 코드형 숫자 값(숫자형)
  - ex> ['사과', '바나나', '키위'] => [1,2,3] 
- ```LabelEncoder``` 클래스로 구현
```Python
from sklearn.preprocessing import LabelEncoder
```
- LabelEncoder 객체를 생성 후 ```fit()```, ```transform()```을 호출해 라벨 인코딩을 수행
- 문자열 값이 어떤 숫자 값으로 인코딩됐는지 확인하기 위해 LabelEncoder 객체의 ```classes_``` 속성값을 확인 가능
  - 0번부터 순서대로 변환된 인코딩 값에 대한 원본값을 가지고 있음
  - ```inverse_transform()```을 통해 인코딩된 값을 되돌릴 수 있음(디코딩)
- 레이블 인코딩의 경우 일괄적인 **숫자 값**으로 변환 -> 몇몇 ML 알고리즘에서 예측 성능 저하가 발생할 수 있음
  - 숫자 값의 크고 작음이 특성으로 작용하는 경우(선형 회귀 등)
  - 트리 계열의 알고리즘의 경우 숫자 값의 크고 작음에 영향 x -> 라벨 인코딩을 활용해도  ok
  - 이를 해결하기 위해 **원-핫 인코딩**을 활용 

### **b) 원-핫 인코딩(One - hot Encoding)**
- 피처 값의 유형에 따라 새로운 피처를 추가해 고유 값에 해당하는 칼럼에만 1을 표시하고 나머지 칼럼에는 0을 표시하는 방식
  - 행 형태로 되어 있는 피처의 고유 값을 **열 형태**로 차원을 변환한 뒤, 고유 값에 해당하는 칼럼에만 1을 표시하고 나머지 칼럼에는 0을 표시하는 방식

<img src = "https://user-images.githubusercontent.com/98953721/229297146-0b84a894-a9e1-4609-bcf3-1151b83b1f9b.png" width = 600 height = 300>

- 사이킷런의 ```OneHotEncoder```로 쉽게 변환 가능
```Python
from sklearn.model_preprocessing import OneHotEncoder
```

- 변환 절차
  1. 모든 문자열 값을 **숫자형** 값으로 변환
    - 주로 LabelEncoder를 활용
  2. 입력 값으로 **2차원 데이터**가 필요

<img src = "https://user-images.githubusercontent.com/98953721/229297554-37e8aa1c-0cba-4b7d-9b4c-90f4d5981f77.png" width = 800 height = 300>

- 판다스의 ```pd.get_dummies()```를 활용하면 해당 작업을 더 간단하게 처리할 수 있음
  - 문자열 카테고리 값을 숫자형으로 변환할 필요 없이 **바로** One-hot Encoding을 수행할 수 있음

## **5-2. 피처 스케일링과 정규화**
### **a) 피처 스케일링(feature scaling)**
- 서로 다른 변수의 값 범위를 **일정한 수준**으로 맞추는 작업 
- 대표적인 방법으로 **표준화(Standardization)**와 **정규화(Normalization)**가 있음
  - 표준화
    - 데이터의 피쳐 값이 각각 평균 = 0, 분산 = 1인 가우시안 정규 분포를 가진 값으로 변환하는 것
    - ${x_{i}}{new} = \frac{x_{i}-mean(x)}{stdev(x)}$
  - 정규화
    - 서로 다른 피처의 크기를 **통일**하기 위해 크기를 변환해주는 개념
      - 개별 데이터의 크기를 모두 **똑같은** 단위로 변경하는 것
      - $$x_{i}{new} = \frac{x_{i} - min(x)}{max(x) - min(x)}$$
      
  - 사이킷런의 ```Normalizer``` 모듈  
    - 

































